/// ĞĞ²Ñ‚Ğ¾Ñ‚ĞµÑÑ‚ Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ Ğ² ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ "ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ° ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚" (category_id=5)
///
/// Ğ­Ñ‚Ğ¾Ñ‚ Ñ‚ĞµÑÑ‚ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ:
/// 1. ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ğ°
/// 2. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²/Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ 5
/// 3. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ² Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
/// 4. Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
/// 5. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ
/// 6. Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
///
/// ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ 5: "ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ° ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚"
/// ĞÑ‚Ğ»Ğ¸Ñ‡Ğ¸Ñ Ğ¾Ñ‚ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ 2 (ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ° ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€):
/// - ĞšĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ° Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ñ†ĞµĞ»Ğ¾Ğ¹ ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ñ‹
/// - ĞŸĞ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹ Ğ¼ĞµĞ½ÑŒÑˆĞµ
/// - Ğ”Ñ€ÑƒĞ³Ğ¸Ğµ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ñ‹ (Ğ±ĞµĞ· ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ° ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚)

import 'package:http/http.dart' as http;
import 'dart:convert';
import 'dart:io';

void main() async {
  const String baseUrl = 'https://dev-api.lidle.io/v1';

  // Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ ÑƒÑ‡ĞµÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
  const String testEmail = 'sonyworkweb@gmail.com';
  const String testPassword = '12345678';

  print('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  print('ğŸ§ª ĞĞ’Ğ¢ĞĞ¢Ğ•Ğ¡Ğ¢: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ Ğ² ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ "ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ° ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚"');
  print('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

  String? token;

  // ============================================================
  // Ğ¨ĞĞ“ 1: ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
  // ============================================================
  print('ğŸ“ Ğ¨ĞĞ“ 1: ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ...');
  print('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');

  try {
    final loginResponse = await http.post(
      Uri.parse('$baseUrl/auth/login'),
      headers: {
        'Accept': 'application/json',
        'X-App-Client': 'mobile',
        'Content-Type': 'application/json',
      },
      body: jsonEncode({
        'email': testEmail,
        'password': testPassword,
        'remember': true,
      }),
    );

    print('Status: ${loginResponse.statusCode}');

    if (loginResponse.statusCode == 200) {
      final loginData = jsonDecode(loginResponse.body);
      token = loginData['access_token'];
      print('âœ… ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑƒÑĞ¿ĞµÑˆĞ½Ğ°!');
      print('   Token preview: ${token?.substring(0, 30)}...');
    } else {
      final errorData = jsonDecode(loginResponse.body);
      print('âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸: ${errorData['message']}');
      return;
    }
  } catch (e) {
    print('âŒ Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸: $e');
    return;
  }

  print('');

  // ============================================================
  // Ğ¨ĞĞ“ 2: ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ (category_id=5)
  // ============================================================
  print('ğŸ“ Ğ¨ĞĞ“ 2: ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ...');
  print('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');

  List<dynamic> attributes = [];

  try {
    // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ /adverts/create Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ² ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ
    final createParamsResponse =
        await http.Request('GET', Uri.parse('$baseUrl/adverts/create'))
          ..headers.addAll({
            'Authorization': 'Bearer $token',
            'Accept': 'application/json',
            'X-App-Client': 'mobile',
            'Content-Type': 'application/json',
          })
          ..body = jsonEncode({'category_id': 5});

    final streamedResponse = await createParamsResponse.send();
    final createParamsBody = await http.Response.fromStream(streamedResponse);

    print('Status: ${createParamsBody.statusCode}');

    if (createParamsBody.statusCode == 200) {
      final data = jsonDecode(createParamsBody.body);

      // Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸
      print('ğŸ“¦ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°:');
      print('   data type: ${data.runtimeType}');
      print('   data.data exists: ${data['data'] != null}');

      // data['data'] Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ List Ğ¸Ğ»Ğ¸ Map
      final dataNode = data['data'];
      print('   data.data type: ${dataNode?.runtimeType}');

      // ĞÑ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ñ‹ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ² Ñ€Ğ°Ğ·Ğ½Ñ‹Ñ… Ğ¼ĞµÑÑ‚Ğ°Ñ… Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
      dynamic attrsRaw;
      if (dataNode is List && dataNode.isNotEmpty) {
        // Ğ•ÑĞ»Ğ¸ data.data ÑÑ‚Ğ¾ List, Ğ±ĞµÑ€Ñ‘Ğ¼ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚
        final firstItem = dataNode[0] as Map<String, dynamic>?;
        attrsRaw = firstItem?['attributes'];
        print('   data.data[0].attributes exists: ${attrsRaw != null}');
      } else if (dataNode is Map<String, dynamic>) {
        attrsRaw = dataNode['attributes'];
        print('   data.data.attributes exists: ${attrsRaw != null}');
      }

      print('   attributes type: ${attrsRaw?.runtimeType}');

      if (attrsRaw is List) {
        attributes = attrsRaw;
      } else if (attrsRaw is Map) {
        // Ğ•ÑĞ»Ğ¸ attributes ÑÑ‚Ğ¾ Map Ñ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ñ‹Ğ¼Ğ¸ ĞºĞ»ÑÑ‡Ğ°Ğ¼Ğ¸-ÑÑ‚Ñ€Ğ¾ĞºĞ°Ğ¼Ğ¸
        attributes = attrsRaw.values.toList();
        print('   Converted Map to List: ${attributes.length} items');
      }

      print('âœ… ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾ ${attributes.length} Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ');
      print('');
      print('ğŸ“Š Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ "ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ° ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚":');
      print(
        'â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”',
      );
      print(
        'â”‚   ID   â”‚ Title                              â”‚ is_rangeâ”‚is_multipleâ”‚ required â”‚',
      );
      print(
        'â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤',
      );

      for (final attr in attributes) {
        try {
          // attr Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Map Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼Ğ¸ Ñ‚Ğ¸Ğ¿Ğ°Ğ¼Ğ¸ ĞºĞ»ÑÑ‡ĞµĞ¹
          final attrMap = attr as Map;

          // ID Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ int Ğ¸Ğ»Ğ¸ String - Ğ¿Ñ€Ğ¸Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ğº int
          final idRaw = attrMap['id'];
          final id = idRaw is int ? idRaw : int.tryParse(idRaw.toString()) ?? 0;
          final title = ((attrMap['title'] ?? '(Ğ±ĞµĞ· Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ)') as String)
              .padRight(34);
          final isRange = attrMap['is_range'] ?? false;
          final isMultiple = attrMap['is_multiple'] ?? false;
          final isRequired = attrMap['is_required'] ?? false;
          final style = attrMap['style']?.toString() ?? 'null';
          final isPopup = attrMap['is_popup'] ?? false;
          final isSpecialDesign = attrMap['is_special_design'] ?? false;
          final isTitleHidden = attrMap['is_title_hidden'] ?? false;
          final dataType = attrMap['data_type']?.toString() ?? 'null';
          final valuesRaw = attrMap['values'];
          final valuesCount = (valuesRaw is List) ? valuesRaw.length : 0;

          print(
            'â”‚ ${id.toString().padLeft(6)} â”‚ $title â”‚ ${isRange.toString().padLeft(7)} â”‚ ${isMultiple.toString().padLeft(8)} â”‚ ${isRequired.toString().padLeft(8)} â”‚',
          );
          // Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑÑ‚Ğ¸Ğ»Ğµ
          print(
            'â”‚        â”‚ style=$style, is_popup=$isPopup, is_special_design=$isSpecialDesign, is_title_hidden=$isTitleHidden, data_type=$dataType',
          );

          if (valuesCount > 0 && valuesRaw is List) {
            print('â”‚        â”‚ Values ($valuesCount):');
            for (final val in valuesRaw.take(5)) {
              final valMap = val as Map;
              print('â”‚        â”‚   - ID=${valMap['id']}: "${valMap['value']}"');
            }
            if (valuesCount > 5) {
              print('â”‚        â”‚   ... Ğ¸ ĞµÑ‰Ñ‘ ${valuesCount - 5}');
            }
          }
        } catch (e) {
          print('â”‚ ERROR  â”‚ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ° Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ°: $e');
        }
      }
      print(
        'â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜',
      );
    } else {
      print('âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ²');
      print('   Response: ${createParamsBody.body}');
    }
  } catch (e, stackTrace) {
    print('âŒ Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ²: $e');
    print('   StackTrace: $stackTrace');
  }

  print('');

  // ============================================================
  // Ğ¨ĞĞ“ 3: ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ² Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
  // ============================================================
  print('ğŸ“ Ğ¨ĞĞ“ 3: ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ² Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ...');
  print('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');

  int? userPhoneId;
  int? userEmailId;

  try {
    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ñ‹
    final phonesResponse = await http.get(
      Uri.parse('$baseUrl/me/settings/phones'),
      headers: {
        'Authorization': 'Bearer $token',
        'Accept': 'application/json',
        'X-App-Client': 'mobile',
      },
    );

    if (phonesResponse.statusCode == 200) {
      final phonesData = jsonDecode(phonesResponse.body);
      final phones = phonesData['data'] as List?;
      if (phones != null && phones.isNotEmpty) {
        userPhoneId = phones[0]['id'];
        print('âœ… Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½: ID=$userPhoneId, number=${phones[0]['phone']}');
      }
    }

    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ email
    final emailsResponse = await http.get(
      Uri.parse('$baseUrl/me/settings/emails'),
      headers: {
        'Authorization': 'Bearer $token',
        'Accept': 'application/json',
        'X-App-Client': 'mobile',
      },
    );

    if (emailsResponse.statusCode == 200) {
      final emailsData = jsonDecode(emailsResponse.body);
      final emails = emailsData['data'] as List?;
      if (emails != null && emails.isNotEmpty) {
        userEmailId = emails[0]['id'];
        print('âœ… Email: ID=$userEmailId, email=${emails[0]['email']}');
      }
    }
  } catch (e) {
    print('âŒ Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ²: $e');
  }

  if (userPhoneId == null) {
    print('âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ: ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ID Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ');
    return;
  }

  print('');

  // ============================================================
  // Ğ¨ĞĞ“ 4: ĞŸĞ¾Ğ¸ÑĞº Ğ°Ğ´Ñ€ĞµÑĞ°
  // ============================================================
  print('ğŸ“ Ğ¨ĞĞ“ 4: ĞŸĞ¾Ğ¸ÑĞº Ğ°Ğ´Ñ€ĞµÑĞ°...');
  print('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');

  int? mainRegionId;
  int? addressRegionId;
  int? cityId;
  int? streetId;

  try {
    // Ğ˜Ñ‰ĞµĞ¼ Ğ³Ğ¾Ñ€Ğ¾Ğ´ ĞœĞ°Ñ€Ğ¸ÑƒĞ¿Ğ¾Ğ»ÑŒ
    final addressResponse =
        await http.Request('GET', Uri.parse('$baseUrl/addresses/search'))
          ..headers.addAll({
            'Authorization': 'Bearer $token',
            'Accept': 'application/json',
            'X-App-Client': 'mobile',
            'Content-Type': 'application/json',
          })
          ..body = jsonEncode({
            'q': 'ĞœĞ°Ñ€Ğ¸ÑƒĞ¿Ğ¾Ğ»ÑŒ',
            'types': ['city'],
          });

    final streamedResponse = await addressResponse.send();
    final addressBody = await http.Response.fromStream(streamedResponse);

    if (addressBody.statusCode == 200) {
      final addressData = jsonDecode(addressBody.body);
      final results = addressData['data'] as List?;

      if (results != null && results.isNotEmpty) {
        final firstResult = results[0];
        mainRegionId = firstResult['main_region']?['id'];
        addressRegionId = firstResult['region']?['id'];
        cityId = firstResult['city']?['id'];

        print('âœ… ĞĞ°Ğ¹Ğ´ĞµĞ½ Ğ³Ğ¾Ñ€Ğ¾Ğ´:');
        print('   main_region.id: $mainRegionId');
        print('   region.id: $addressRegionId');
        print('   city.id: $cityId');
      }
    }

    // Ğ˜Ñ‰ĞµĞ¼ ÑƒĞ»Ğ¸Ñ†Ñƒ
    if (cityId != null) {
      final streetResponse =
          await http.Request('GET', Uri.parse('$baseUrl/addresses/search'))
            ..headers.addAll({
              'Authorization': 'Bearer $token',
              'Accept': 'application/json',
              'X-App-Client': 'mobile',
              'Content-Type': 'application/json',
            })
            ..body = jsonEncode({
              'q': 'ĞÑ€Ñ‚Ñ‘Ğ¼Ğ°',
              'types': ['street'],
              'filters': {'city_id': cityId},
            });

      final streetStreamedResponse = await streetResponse.send();
      final streetBody = await http.Response.fromStream(streetStreamedResponse);

      if (streetBody.statusCode == 200) {
        final streetData = jsonDecode(streetBody.body);
        final streetResults = streetData['data'] as List?;

        if (streetResults != null && streetResults.isNotEmpty) {
          streetId = streetResults[0]['street']?['id'];
          print('âœ… ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ° ÑƒĞ»Ğ¸Ñ†Ğ°: street.id=$streetId');
        }
      }
    }
  } catch (e) {
    print('âŒ Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ¸ÑĞºĞµ Ğ°Ğ´Ñ€ĞµÑĞ°: $e');
  }

  print('');

  // ============================================================
  // Ğ¨ĞĞ“ 5: Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ½Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ
  // ============================================================
  print('ğŸ“ Ğ¨ĞĞ“ 5: Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°...');
  print('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');

  // ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ğ¼ Ğ½ÑƒĞ¶Ğ½Ñ‹Ğµ value_id Ğ´Ğ»Ñ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ² ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ 5
  int? sellerTypeValueId; // ID Ğ´Ğ»Ñ "Ğ§Ğ°ÑÑ‚Ğ½Ğ¾Ğµ Ğ»Ğ¸Ñ†Ğ¾" (Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚!)
  int? offerPriceAttrId; // ID Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ° "Ğ’Ğ°Ğ¼ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ°Ñ‚ Ñ†ĞµĞ½Ñƒ" (Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹!)
  int? areaAttrId; // ID Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ° "ĞĞ±Ñ‰Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ" (Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹!)
  int? floorAttrId; // ID Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ° "Ğ­Ñ‚Ğ°Ğ¶"
  int? bargainValueId; // ID Ğ´Ğ»Ñ "Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½ Ñ‚Ğ¾Ñ€Ğ³"
  int? roomsValueId; // ID Ğ´Ğ»Ñ "ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚" (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ™ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚!)

  for (final attr in attributes) {
    // ID Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ int Ğ¸Ğ»Ğ¸ String - Ğ¿Ñ€Ğ¸Ğ²Ğ¾Ğ´Ğ¸Ğ¼ Ğº int
    final attrIdRaw = attr['id'];
    final attrId = attrIdRaw is int
        ? attrIdRaw
        : int.tryParse(attrIdRaw.toString()) ?? 0;
    final attrTitle = attr['title'] ?? '';

    // Ğ§Ğ°ÑÑ‚Ğ½Ğ¾Ğµ Ğ»Ğ¸Ñ†Ğ¾ / Ğ‘Ğ¸Ğ·Ğ½ĞµÑ (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ™ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚!)
    if (attrTitle == 'Ğ§Ğ°ÑÑ‚Ğ½Ğ¾Ğµ Ğ»Ğ¸Ñ†Ğ¾ / Ğ‘Ğ¸Ğ·Ğ½ĞµÑ' ||
        attrTitle == 'Ğ§Ğ°ÑÑ‚Ğ½Ğ¾Ğµ Ğ»Ğ¸Ñ†Ğ¾ / Ğ‘Ğ¸Ğ·Ğ½ĞµÑ*') {
      final values = attr['values'] as List?;
      if (values != null && values.isNotEmpty) {
        // Ğ‘ĞµÑ€Ñ‘Ğ¼ "Ğ§Ğ°ÑÑ‚Ğ½Ğ¾Ğµ Ğ»Ğ¸Ñ†Ğ¾" (Ğ¿ĞµÑ€Ğ²Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ)
        sellerTypeValueId = values[0]['id'];
        print(
          'âœ… ĞĞ°Ğ¹Ğ´ĞµĞ½ ID Ğ´Ğ»Ñ "Ğ§Ğ°ÑÑ‚Ğ½Ğ¾Ğµ Ğ»Ğ¸Ñ†Ğ¾": $sellerTypeValueId (Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ $attrId)',
        );
      }
    }

    // Ğ’Ğ°Ğ¼ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ°Ñ‚ Ñ†ĞµĞ½Ñƒ (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ™ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚!)
    if (attrTitle == 'Ğ’Ğ°Ğ¼ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ°Ñ‚ Ñ†ĞµĞ½Ñƒ' ||
        attrTitle == 'Ğ’Ğ°Ğ¼ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ°Ñ‚ Ñ†ĞµĞ½Ñƒ*') {
      offerPriceAttrId = attrId;
      print('âœ… ĞĞ°Ğ¹Ğ´ĞµĞ½ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ "Ğ’Ğ°Ğ¼ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ°Ñ‚ Ñ†ĞµĞ½Ñƒ": ID=$offerPriceAttrId');
    }

    // ĞĞ±Ñ‰Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ™ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚!)
    if (attrTitle == 'ĞĞ±Ñ‰Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ' || attrTitle == 'ĞĞ±Ñ‰Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ*') {
      areaAttrId = attrId;
      print('âœ… ĞĞ°Ğ¹Ğ´ĞµĞ½ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ "ĞĞ±Ñ‰Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ": ID=$areaAttrId');
    }

    // Ğ­Ñ‚Ğ°Ğ¶
    if (attrTitle == 'Ğ­Ñ‚Ğ°Ğ¶' || attrTitle == 'Ğ­Ñ‚Ğ°Ğ¶*') {
      floorAttrId = attrId;
      print('âœ… ĞĞ°Ğ¹Ğ´ĞµĞ½ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ "Ğ­Ñ‚Ğ°Ğ¶": ID=$floorAttrId');
    }

    // Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½ Ñ‚Ğ¾Ñ€Ğ³
    if (attrTitle == 'Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½ Ñ‚Ğ¾Ñ€Ğ³') {
      final values = attr['values'] as List?;
      if (values != null && values.isNotEmpty) {
        bargainValueId = values[0]['id'];
        print('âœ… ĞĞ°Ğ¹Ğ´ĞµĞ½ ID Ğ´Ğ»Ñ "Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½ Ñ‚Ğ¾Ñ€Ğ³": $bargainValueId');
      }
    }

    // ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚ (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ™ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ Ğ´Ğ»Ñ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ 5!)
    if (attrTitle == 'ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚' || attrTitle == 'ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚*') {
      final values = attr['values'] as List?;
      if (values != null && values.isNotEmpty) {
        // Ğ‘ĞµÑ€Ñ‘Ğ¼ "1" (Ğ¿ĞµÑ€Ğ²Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ) - Ğ¾Ğ´Ğ½Ğ° ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ°
        roomsValueId = values[0]['id'];
        print('âœ… ĞĞ°Ğ¹Ğ´ĞµĞ½ ID Ğ´Ğ»Ñ "1 ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ°": $roomsValueId (Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ $attrId)');
      }
    }
  }

  // Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµĞ¼ attributes Ğ´Ğ»Ñ API
  final Map<String, dynamic> requestAttributes = {
    'value_selected': <int>[],
    'values': <String, dynamic>{},
  };

  // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ "Ğ§Ğ°ÑÑ‚Ğ½Ğ¾Ğµ Ğ»Ğ¸Ñ†Ğ¾" (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ™ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚!)
  if (sellerTypeValueId != null) {
    requestAttributes['value_selected'].add(sellerTypeValueId);
    print('   Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ² value_selected: $sellerTypeValueId (Ğ§Ğ°ÑÑ‚Ğ½Ğ¾Ğµ Ğ»Ğ¸Ñ†Ğ¾)');
  } else {
    print(
      'âš ï¸ Ğ’ĞĞ˜ĞœĞĞĞ˜Ğ•: ĞĞµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ "Ğ§Ğ°ÑÑ‚Ğ½Ğ¾Ğµ Ğ»Ğ¸Ñ†Ğ¾ / Ğ‘Ğ¸Ğ·Ğ½ĞµÑ"!',
    );
  }

  // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ "Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½ Ñ‚Ğ¾Ñ€Ğ³"
  if (bargainValueId != null) {
    requestAttributes['value_selected'].add(bargainValueId);
    print('   Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ² value_selected: $bargainValueId (Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½ Ñ‚Ğ¾Ñ€Ğ³)');
  }

  // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ "ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚" (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ™ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚!)
  if (roomsValueId != null) {
    requestAttributes['value_selected'].add(roomsValueId);
    print('   Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ² value_selected: $roomsValueId (1 ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ°)');
  } else {
    print('âš ï¸ Ğ’ĞĞ˜ĞœĞĞĞ˜Ğ•: ĞĞµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ "ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚"!');
    // Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğ¹ ID Ğ´Ğ»Ñ "1 ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ°"
    requestAttributes['value_selected'].add(436);
    print('   Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğ¹ ID 436 Ğ´Ğ»Ñ "1 ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ°"');
  }

  // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ "Ğ’Ğ°Ğ¼ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ°Ñ‚ Ñ†ĞµĞ½Ñƒ" (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ™ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚!)
  // Ğ­Ñ‚Ğ¾ Ğ±ÑƒĞ»ĞµĞ²Ñ‹Ğ¹ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ - Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ğ¼ {value: 1} Ğ² values
  if (offerPriceAttrId != null) {
    requestAttributes['values'][offerPriceAttrId.toString()] = {'value': 1};
    print(
      '   Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ² values[$offerPriceAttrId]: {value: 1} (Ğ’Ğ°Ğ¼ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ°Ñ‚ Ñ†ĞµĞ½Ñƒ)',
    );
  } else {
    print('âš ï¸ Ğ’ĞĞ˜ĞœĞĞĞ˜Ğ•: ĞĞµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ "Ğ’Ğ°Ğ¼ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ°Ñ‚ Ñ†ĞµĞ½Ñƒ"!');
    // Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğ¹ ID Ğ´Ğ»Ñ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ 5
    requestAttributes['values']['1052'] = {'value': 1};
    print('   Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğ¹ ID 1052 Ğ´Ğ»Ñ "Ğ’Ğ°Ğ¼ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ°Ñ‚ Ñ†ĞµĞ½Ñƒ"');
  }

  // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ "ĞĞ±Ñ‰Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ" (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğ™ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚!)
  if (areaAttrId != null) {
    requestAttributes['values'][areaAttrId.toString()] = {'value': 18.5};
    print('   Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ² values[$areaAttrId]: {value: 18.5} (ĞĞ±Ñ‰Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ)');
  } else {
    print('âš ï¸ Ğ’ĞĞ˜ĞœĞĞĞ˜Ğ•: ĞĞµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚ "ĞĞ±Ñ‰Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ"!');
    // Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğ¹ ID Ğ´Ğ»Ñ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ 5
    requestAttributes['values']['1130'] = {'value': 18.5};
    print('   Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğ¹ ID 1130 Ğ´Ğ»Ñ "ĞĞ±Ñ‰Ğ°Ñ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ"');
  }

  // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ "Ğ­Ñ‚Ğ°Ğ¶"
  if (floorAttrId != null) {
    requestAttributes['values'][floorAttrId.toString()] = {
      'value': 3,
      'max_value': 5,
    };
    print(
      '   Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ² values[$floorAttrId]: {value: 3, max_value: 5} (Ğ­Ñ‚Ğ°Ğ¶)',
    );
  }

  // Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
  // ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ Ğ´Ğ»Ğ¸Ğ½Ğ½ĞµĞµ 255 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²!
  const shortDescription =
      'ĞŸÑ€Ğ¾Ğ´Ğ°Ñ‘Ñ‚ÑÑ ÑĞ²ĞµÑ‚Ğ»Ğ°Ñ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ° 18 Ğ¼Â² Ğ² Ñ‚Ñ€Ñ‘Ñ…ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ½Ğ¾Ğ¹ ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ğµ. '
      'Ğ˜Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ, Ñ Ğ±Ğ°Ğ»ĞºĞ¾Ğ½Ğ¾Ğ¼, ĞºĞ¾ÑĞ¼ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€ĞµĞ¼Ğ¾Ğ½Ñ‚. '
      'ĞšÑƒÑ…Ğ½Ñ Ğ¸ ÑĞ°Ğ½ÑƒĞ·ĞµĞ» Ğ² ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ½Ğ¾Ğ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¸. Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğµ ÑĞ¾ÑĞµĞ´Ğ¸, Ñ‚Ğ¸Ñ…Ğ¸Ğ¹ Ñ€Ğ°Ğ¹Ğ¾Ğ½.';

  final createRequest = {
    'name': 'Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ğ°Ñ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ° 18 Ğ¼Â² Ğ² Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğµ',
    'description': shortDescription, // ~180 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²
    'price': '850000', // Ğ¦ĞµĞ½Ğ° Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹
    'category_id': 5, // ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ° ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚
    'region_id': mainRegionId ?? 1, // main_region.id
    'address': {
      'region_id': addressRegionId,
      'city_id': cityId,
      'street_id': streetId,
      'building_number': '15',
    },
    'attributes': requestAttributes,
    'contacts': {
      'user_phone_id': userPhoneId,
      if (userEmailId != null) 'user_email_id': userEmailId,
    },
    'is_auto_renew': false,
  };

  print('');
  print('ğŸ“¦ Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ:');
  print('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
  print(const JsonEncoder.withIndent('  ').convert(createRequest));
  print('');

  // ============================================================
  // Ğ¨ĞĞ“ 6: ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ½Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ
  // ============================================================
  print('ğŸ“ Ğ¨ĞĞ“ 6: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ...');
  print('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');

  int? advertId;

  try {
    final createResponse = await http.post(
      Uri.parse('$baseUrl/adverts'),
      headers: {
        'Authorization': 'Bearer $token',
        'Accept': 'application/json',
        'X-App-Client': 'mobile',
        'Content-Type': 'application/json',
      },
      body: jsonEncode(createRequest),
    );

    print('Status: ${createResponse.statusCode}');
    print('');

    final responseData = jsonDecode(createResponse.body);

    if (createResponse.statusCode == 201 || createResponse.statusCode == 200) {
      print('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
      print('âœ… ĞĞ‘ĞªĞ¯Ğ’Ğ›Ğ•ĞĞ˜Ğ• Ğ£Ğ¡ĞŸĞ•Ğ¨ĞĞ Ğ¡ĞĞ—Ğ”ĞĞĞ!');
      print('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
      print('');
      print('Response:');
      print(const JsonEncoder.withIndent('  ').convert(responseData));

      // Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ ID ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ
      if (responseData['data'] != null) {
        if (responseData['data'] is List &&
            (responseData['data'] as List).isNotEmpty) {
          advertId = (responseData['data'] as List)[0]['id'];
        } else if (responseData['data'] is Map) {
          advertId = responseData['data']['id'];
        }
        if (advertId != null) {
          print('');
          print('ğŸ†” ID ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ: $advertId');
        }
      }
    } else {
      print('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
      print('âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ Ğ¡ĞĞ—Ğ”ĞĞĞ˜Ğ¯ ĞĞ‘ĞªĞ¯Ğ’Ğ›Ğ•ĞĞ˜Ğ¯');
      print('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
      print('');
      print('Message: ${responseData['message']}');

      if (responseData['errors'] != null) {
        print('');
        print('ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸:');
        final errors = responseData['errors'] as Map;
        errors.forEach((key, value) {
          print('  âŒ $key: $value');
        });
      }

      print('');
      print('Full response:');
      print(const JsonEncoder.withIndent('  ').convert(responseData));
    }
  } catch (e) {
    print('âŒ Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ: $e');
  }

  // ============================================================
  // Ğ¨ĞĞ“ 7: Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
  // ============================================================
  if (advertId != null) {
    print('');
    print('ğŸ“ Ğ¨ĞĞ“ 7: Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ...');
    print('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');

    // ĞŸÑƒÑ‚ÑŒ Ğº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¼Ñƒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ 5 (ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ° ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚)
    // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ñ‹/ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ñ‹
    final imagePath = 'assets/home_page/1700659569_t16.jpg';
    final imageFile = File(imagePath);

    if (await imageFile.exists()) {
      print('ğŸ“· ĞĞ°Ğ¹Ğ´ĞµĞ½ Ñ„Ğ°Ğ¹Ğ» Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ: $imagePath');
      print('   Ğ Ğ°Ğ·Ğ¼ĞµÑ€: ${await imageFile.length()} Ğ±Ğ°Ğ¹Ñ‚');

      try {
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ multipart Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
        final uploadRequest = http.MultipartRequest(
          'POST',
          Uri.parse('$baseUrl/adverts/$advertId/images'),
        );

        // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
        uploadRequest.headers.addAll({
          'Authorization': 'Bearer $token',
          'Accept': 'application/json',
          'X-App-Client': 'mobile',
        });

        // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ„Ğ°Ğ¹Ğ»
        uploadRequest.files.add(
          await http.MultipartFile.fromPath('images[0]', imagePath),
        );

        print('ğŸ“¤ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€...');

        final uploadStreamedResponse = await uploadRequest.send();
        final uploadResponse = await http.Response.fromStream(
          uploadStreamedResponse,
        );

        print('Status: ${uploadResponse.statusCode}');

        if (uploadResponse.statusCode == 200) {
          final uploadData = jsonDecode(uploadResponse.body);
          print(
            'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•',
          );
          print('âœ… Ğ˜Ğ—ĞĞ‘Ğ ĞĞ–Ğ•ĞĞ˜Ğ• Ğ£Ğ¡ĞŸĞ•Ğ¨ĞĞ Ğ—ĞĞ“Ğ Ğ£Ğ–Ğ•ĞĞ!');
          print(
            'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•',
          );
          print('');
          print('Response:');
          print(const JsonEncoder.withIndent('  ').convert(uploadData));
        } else {
          final uploadData = jsonDecode(uploadResponse.body);
          print('âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ:');
          print('   Message: ${uploadData['message']}');
          if (uploadData['errors'] != null) {
            print('   Errors: ${uploadData['errors']}');
          }
        }
      } catch (e) {
        print('âŒ Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ: $e');
      }
    } else {
      print('âš ï¸ Ğ¤Ğ°Ğ¹Ğ» Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½: $imagePath');
      print('   ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºÑƒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ.');
    }
  }

  print('');
  print('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  print('ğŸ Ğ¢Ğ•Ğ¡Ğ¢ Ğ—ĞĞ’Ğ•Ğ Ğ¨ĞĞ');
  print('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
}
